<!doctype html><html lang=en dir=ZgotmplZ><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Defense"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://xsleaks.dev/category/defense/"><title>Defense | XS-Leaks Wiki</title>
<link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.1c9a9009be3c645cbccbe64eb0a90e28621e4118971d9a502db4aaa9bec96cfc.css integrity="sha256-HJqQCb48ZFy8y+ZOsKkOKGIeQRiXHZpQLbSqqb7JbPw="><script defer src=/en.search.min.99c15d7ff493d689ec259924b6ede36226b10d07da843285e55bdf7f1a66f17e.js integrity="sha256-mcFdf/ST1onsJZkktu3jYiaxDQfahDKF5Vvffxpm8X4="></script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk="></script><link rel=alternate type=application/rss+xml href=https://xsleaks.dev/category/defense/index.xml title="XS-Leaks Wiki"></head><body dir=ZgotmplZ><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>XS-Leaks Wiki</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Attacks</span><ul><li><a href=/docs/attacks/xs-search/>XS-Search</a></li><li><a href=/docs/attacks/window-references/>Window References</a></li><li><a href=/docs/attacks/css-tricks/>CSS Tricks</a></li><li><a href=/docs/attacks/error-events/>Error Events</a></li><li><a href=/docs/attacks/frame-counting/>Frame Counting</a></li><li><a href=/docs/attacks/navigations/>Navigations</a></li><li><a href=/docs/attacks/cache-probing/>Cache Probing</a></li><li><a href=/docs/attacks/element-leaks/>Element leaks</a></li><li><a href=/docs/attacks/id-attribute/>ID Attribute</a></li><li><a href=/docs/attacks/postmessage-broadcasts/>postMessage Broadcasts</a></li><li><span>Browser Features</span><ul><li><a href=/docs/attacks/browser-features/corb/>CORB Leaks</a></li><li><a href=/docs/attacks/browser-features/corp/>CORP Leaks</a></li></ul></li><li><span>Timing Attacks</span><ul><li><a href=/docs/attacks/timing-attacks/clocks/>Clocks</a></li><li><a href=/docs/attacks/timing-attacks/network-timing/>Network Timing</a></li><li><a href=/docs/attacks/timing-attacks/performance-api/>Performance API</a></li><li><a href=/docs/attacks/timing-attacks/execution-timing/>Execution Timing</a></li><li><a href=/docs/attacks/timing-attacks/hybrid-timing/>Hybrid Timing</a></li><li><a href=/docs/attacks/timing-attacks/connection-pool/>Connection Pool</a></li></ul></li><li><a href=/docs/attacks/experiments/ class=collapsed>Experiments</a></li><li><a href=/docs/attacks/css-injection/>CSS Injection</a></li><li><a href=/docs/attacks/historical/ class=collapsed>Historical</a></li></ul></li><li class=book-section-flat><a href=/docs/defenses/>Defense Mechanisms</a><ul><li><a href=/docs/defenses/design-protections/>Application Design</a><ul><li><a href=/docs/defenses/design-protections/cache-protections/>Cache Protections</a></li><li><a href=/docs/defenses/design-protections/subresource-protections/>Subresource Protections</a></li></ul></li><li><a href=/docs/defenses/opt-in/>Opt-In Mechanisms</a><ul><li><a href=/docs/defenses/opt-in/fetch-metadata/>Fetch Metadata</a></li><li><a href=/docs/defenses/opt-in/coop/>Cross-Origin-Opener-Policy</a></li><li><a href=/docs/defenses/opt-in/corp/>Cross-Origin-Resource-Policy</a></li><li><a href=/docs/defenses/opt-in/xfo/>Framing Protections</a></li><li><a href=/docs/defenses/opt-in/same-site-cookies/>SameSite Cookies</a></li><li><a href=/docs/defenses/opt-in/document-policies/>Document Policies</a></li></ul></li><li><a href=/docs/defenses/isolation-policies/>Isolation Policies</a><ul><li><a href=/docs/defenses/isolation-policies/resource-isolation/>Resource Isolation Policy</a></li><li><a href=/docs/defenses/isolation-policies/framing-isolation/>Framing Isolation Policy</a></li><li><a href=/docs/defenses/isolation-policies/navigation-isolation/>Navigation Isolation Policy</a></li><li><a href=/docs/defenses/isolation-policies/strict-isolation/>Strict Isolation Policy</a></li></ul></li><li><a href=/docs/defenses/secure-defaults/>Secure Defaults</a><ul><li><a href=/docs/defenses/secure-defaults/corb/>Cross-Origin Read Blocking</a></li><li><a href=/docs/defenses/secure-defaults/partitioned-cache/>Partitioned HTTP Cache</a></li></ul></li></ul></li><li class=book-section-flat><a href=/docs/contributions/>Contributions</a><ul></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Defense</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Abuse</strong><ul><li class="flex justify-between"><a href=/abuse/window-references/>Window References</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/browser-feature/>Browser Feature</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/browser-limits/>Browser Limits</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/connection-pool/>Connection Pool</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/content-type/>Content-Type</a>
<span>3</span></li><li class="flex justify-between"><a href=/abuse/csp-violations/>CSP Violations</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/css/>CSS</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/css-injections/>CSS Injections</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/downloads/>Downloads</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/error-events/>Error Events</a>
<span>3</span></li><li class="flex justify-between"><a href=/abuse/event-loop/>Event Loop</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/focus/>focus</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/history/>History</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/iframes/>iframes</a>
<span>9</span></li><li class="flex justify-between"><a href=/abuse/nosniff/>nosniff</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/onblur/>onblur</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/postmessage/>postMessage</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/redirects/>Redirects</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/regex-injections/>Regex Injections</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/service-workers/>Service Workers</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/site-isolation/>Site Isolation</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/status-code/>Status Code</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/typemustmatch/>typeMustMatch</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/window.open/>window.open</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/window.performance/>window.performance</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/window.stop/>window.stop</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/abortcontroller/>AbortController</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/cache/>Cache</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/htmlelement/>HTMLElement</a>
<span>1</span></li></ul></li><li class=book-section-flat><strong>Category</strong><ul><li class="flex justify-between"><a href=/category/defense/>Defense</a>
<span>14</span></li><li class="flex justify-between"><a href=/category/attack/>Attack</a>
<span>18</span></li><li class="flex justify-between"><a href=/category/attack-principle/>Attack Principle</a>
<span>1</span></li><li class="flex justify-between"><a href=/category/experiments/>Experiments</a>
<span>2</span></li><li class="flex justify-between"><a href=/category/historical/>Historical</a>
<span>2</span></li><li class="flex justify-between"><a href=/category/instrument/>Instrument</a>
<span>1</span></li></ul></li><li class=book-section-flat><strong>Defenses</strong><ul><li class="flex justify-between"><a href=/defenses/coop/>COOP</a>
<span>6</span></li><li class="flex justify-between"><a href=/defenses/fetch-metadata/>Fetch Metadata</a>
<span>12</span></li><li class="flex justify-between"><a href=/defenses/samesite-cookies/>SameSite Cookies</a>
<span>15</span></li><li class="flex justify-between"><a href=/defenses/application-fix/>Application Fix</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/browser-fix/>Browser Fix</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/corb/>CORB</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/deprecation/>Deprecation</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/document-policies/>Document Policies</a>
<span>2</span></li><li class="flex justify-between"><a href=/defenses/framing-protections/>Framing Protections</a>
<span>6</span></li><li class="flex justify-between"><a href=/defenses/subresource-protections/>Subresource Protections</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/vary-sec-fetch-site/>Vary: Sec-Fetch-Site</a>
<span>1</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/docs/defenses/isolation-policies/resource-isolation/>Resource Isolation Policy</a></h2><h5>November 30, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>Resource Isolation Policy prevents external websites from requesting your resources. Blocking such traffic mitigates common web vulnerabilities such as CSRF, XSSI, or XS-Leaks. The policy can be enabled for applications whose endpoints are not intended to be loaded in a cross-site context and will allow resource requests coming from your application as well as direct navigations.
Implementation with Fetch Metadata # The below snippet showcases an example implemention of the Resource Isolation Policy with the use of Fetch Metadata headers:
<a href=/docs/defenses/isolation-policies/resource-isolation/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/isolation-policies/framing-isolation/>Framing Isolation Policy</a></h2><h5>November 30, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>Framing Isolation Policy is a stricter version of Framing Protections where the request gets blocked at the application level rather than by the browser. This is designed to protect against various attacks (e.g. XSSI, CSRF, XS-Leaks) by blocking framing requests to endpoints that are not intended to be framable.
It can be combined with Resource Isolation Policy to effectively tighten the attack surface within cross-site information leaks.
tip
Instead of rejecting all non-framable endpoints, the user could be prompted to confirm the action, e.
<a href=/docs/defenses/isolation-policies/framing-isolation/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/isolation-policies/navigation-isolation/>Navigation Isolation Policy</a></h2><h5>November 30, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>Navigation Isolation Policy is a server-side protection mechanism intended to mitigate CSRF, clickjacking, reflected XSS, and XS-Leaks that make use of cross-site window contexts. This is a strict policy and has the potential to break an application since it blocks all cross-site navigations, including navigations through hyperlinks.
tip
Instead of rejecting all cross-site interactions, the user could be prompted to confirm the action, e.g. Confirm that you visited this page from a trusted origin, to mitigate the risk of attacks in the background, and, at the same time, help prevent unintended breakages of an application.
<a href=/docs/defenses/isolation-policies/navigation-isolation/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/isolation-policies/strict-isolation/>Strict Isolation Policy</a></h2><h5>November 30, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>Strict Isolation Policy is intended to protect against all cross-site interactions (including navigations to the application through hyperlinks). This is a very strict policy that has the potential to prevent applications from functioning properly.
tip
Instead of rejecting all cross-site interactions, the user could be prompted to confirm the action, e.g. Confirm that you visited this page from a trusted origin, to mitigate the risk of attacks in the background, and, at the same time, help prevent unintended breakages of an application.
<a href=/docs/defenses/isolation-policies/strict-isolation/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/opt-in/fetch-metadata/>Fetch Metadata</a></h2><h5>November 30, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>Fetch Metadata Request Headers are sent by browsers with HTTPS requests. These headers provide context on how a request was initiated so that applications are able to make more informed decisions on how to respond to them. This allows servers to behave differently when they detect potential attacks (e.g. unexpected cross-origin requests)[^1]. This can be very effective against cross-origin attacks like XSSI, XS-Leaks, Clickjacking, and CSRF if a strict policy is deployed on the server.
<a href=/docs/defenses/opt-in/fetch-metadata/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/design-protections/cache-protections/>Cache Protections</a></h2><h5>October 16, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>There are a number of different approaches applications can use to defend against cache probing-based XS-Leaks. These approaches are explained in the following sections.
Cache Protection via Cache-Control Headers # If it is acceptable to disable caching, doing so provides a strong defense against cache probing attacks. Disabling caching means that every time someone loads a resource, the resource has to be fetched again. To disable caching, set a Cache-Control: no-store header on every single response that you wish to protect.
<a href=/docs/defenses/design-protections/cache-protections/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/secure-defaults/corb/>Cross-Origin Read Blocking</a></h2><h5>October 1, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>Cross-Origin Read Blocking (CORB) is a security mechanism that prevents attackers from loading certain cross-origin resources 1. This protection was created to defend against speculative side-channel attacks such as Spectre that allow attackers to read the memory of the process that both cross-site pages (e.g. attacker.com and sensitive.com) were embedded into. CORB aims to prevent attackers from loading certain sensitive cross-origin resources into an attacker-controlled process. For example, if an attacker tries to load cross-origin HTML, XML, or JSON into an img tag, CORB prevents this from happening.
<a href=/docs/defenses/secure-defaults/corb/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/opt-in/coop/>Cross-Origin-Opener-Policy</a></h2><h5>October 1, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>Getting access to a website&rsquo;s window object is a common prerequisite for different XS-Leak techniques. Framing Protections can ensure that an attacker cannot use iframes to access the window object, but this does not stop an attacker from accessing the window object from an opened window through window.open(url) or window.opener references.
Exploiting XS-Leaks with window.open is generally seen as the least appealing option for an attacker because the user can see it happen in the open browser window.
<a href=/docs/defenses/opt-in/coop/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/opt-in/corp/>Cross-Origin-Resource-Policy</a></h2><h5>October 1, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>Cross-Origin Resource Policy (CORP) is a web platform security feature that allows websites to prevent certain resources from being loaded by other origins. This protection complements CORB since it is an opt-in defense, whereas CORB blocks some cross-origin reads by default. CORP is designed to protect against both speculative execution attacks and XS-Leaks by allowing developers to ensure that sensitive resources cannot end up in attacker-controlled processes. Unlike CORB, this protection is enforced in the browser only if an application opts in to the protection.
<a href=/docs/defenses/opt-in/corp/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/opt-in/xfo/>Framing Protections</a></h2><h5>October 1, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>A considerable number of XS-Leaks rely on some of the properties of iframes. If an attacker is unable to embed the contents of a page as an iframe, frame, embed or object, then the attack may no longer be possible. To mitigate XS-Leaks which rely on these objects, pages can forbid or select which origins can embed them. Doing so is possible by using the X-Frame-Options header or the CSP frame-ancestors directive.
<a href=/docs/defenses/opt-in/xfo/>...</a></p></article><ul class="pagination pagination-default"><li class="page-item disabled"><a aria-disabled=true aria-label=First class=page-link role=button tabindex=-1><span aria-hidden=true>&#171;&#171;</span></a></li><li class="page-item disabled"><a aria-disabled=true aria-label=Previous class=page-link role=button tabindex=-1><span aria-hidden=true>&#171;</span></a></li><li class="page-item active"><a aria-current=page aria-label="Page 1" class=page-link role=button>1</a></li><li class=page-item><a href=/category/defense/page/2/ aria-label="Page 2" class=page-link role=button>2</a></li><li class=page-item><a href=/category/defense/page/2/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/category/defense/page/2/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav><ul><li class=book-section-flat><strong>Abuse</strong><ul><li class="flex justify-between"><a href=/abuse/window-references/>Window References</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/browser-feature/>Browser Feature</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/browser-limits/>Browser Limits</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/connection-pool/>Connection Pool</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/content-type/>Content-Type</a>
<span>3</span></li><li class="flex justify-between"><a href=/abuse/csp-violations/>CSP Violations</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/css/>CSS</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/css-injections/>CSS Injections</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/downloads/>Downloads</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/error-events/>Error Events</a>
<span>3</span></li><li class="flex justify-between"><a href=/abuse/event-loop/>Event Loop</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/focus/>focus</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/history/>History</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/iframes/>iframes</a>
<span>9</span></li><li class="flex justify-between"><a href=/abuse/nosniff/>nosniff</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/onblur/>onblur</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/postmessage/>postMessage</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/redirects/>Redirects</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/regex-injections/>Regex Injections</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/service-workers/>Service Workers</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/site-isolation/>Site Isolation</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/status-code/>Status Code</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/typemustmatch/>typeMustMatch</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/window.open/>window.open</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/window.performance/>window.performance</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/window.stop/>window.stop</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/abortcontroller/>AbortController</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/cache/>Cache</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/htmlelement/>HTMLElement</a>
<span>1</span></li></ul></li><li class=book-section-flat><strong>Category</strong><ul><li class="flex justify-between"><a href=/category/defense/>Defense</a>
<span>14</span></li><li class="flex justify-between"><a href=/category/attack/>Attack</a>
<span>18</span></li><li class="flex justify-between"><a href=/category/attack-principle/>Attack Principle</a>
<span>1</span></li><li class="flex justify-between"><a href=/category/experiments/>Experiments</a>
<span>2</span></li><li class="flex justify-between"><a href=/category/historical/>Historical</a>
<span>2</span></li><li class="flex justify-between"><a href=/category/instrument/>Instrument</a>
<span>1</span></li></ul></li><li class=book-section-flat><strong>Defenses</strong><ul><li class="flex justify-between"><a href=/defenses/coop/>COOP</a>
<span>6</span></li><li class="flex justify-between"><a href=/defenses/fetch-metadata/>Fetch Metadata</a>
<span>12</span></li><li class="flex justify-between"><a href=/defenses/samesite-cookies/>SameSite Cookies</a>
<span>15</span></li><li class="flex justify-between"><a href=/defenses/application-fix/>Application Fix</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/browser-fix/>Browser Fix</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/corb/>CORB</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/deprecation/>Deprecation</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/document-policies/>Document Policies</a>
<span>2</span></li><li class="flex justify-between"><a href=/defenses/framing-protections/>Framing Protections</a>
<span>6</span></li><li class="flex justify-between"><a href=/defenses/subresource-protections/>Subresource Protections</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/vary-sec-fetch-site/>Vary: Sec-Fetch-Site</a>
<span>1</span></li></ul></li></ul></nav></aside></main></body></html>